<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Player Corporativo</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #000;
        }
        #video-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        #message-overlay {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-family: Arial, sans-serif;
            font-size: 1.2em;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
        }
    </style>
</head>
<body>

    <div id="video-container"></div>
    
    <div id="message-overlay">
        <p>Carregando vídeos...</p>
    </div>

    <script>
        const GITHUB_USER = "EdiRC12";
        const GITHUB_REPO = "videoplayer";
        const VIDEOS_PATH = "videos";

        const videoContainer = document.getElementById('video-container');
        const messageOverlay = document.getElementById('message-overlay');
        let videoElement = document.createElement('video');
        videoContainer.appendChild(videoElement);

        let playlist = [];
        let currentVideoIndex = 0;

        function showMessage(text, isError = false) {
            messageOverlay.innerHTML = `<p>${text}</p>`;
            messageOverlay.style.color = isError ? 'red' : 'white';
        }

        async function initializePlayer() {
            console.log("Iniciando player...");
            try {
                const apiUrl = `https://api.github.com/repos/${GITHUB_USER}/${GITHUB_REPO}/contents/${VIDEOS_PATH}`;
                
                const response = await fetch(apiUrl);
                if (!response.ok) {
                    throw new Error(`Erro ao buscar repositório: ${response.statusText}`);
                }
                
                const files = await response.json();
                
                playlist = files
                    .filter(file => file.name.toLowerCase().endsWith('.mp4'))
                    .map(file => file.download_url);

                if (playlist.length === 0) {
                    throw new Error("Nenhum vídeo .mp4 encontrado na pasta. Verifique se os arquivos existem e o nome da pasta está correto.");
                }
                
                messageOverlay.style.display = 'none';

                console.log(`Playlist carregada com ${playlist.length} vídeos.`);
                setupVideoPlayer();
                playNextVideo();

            } catch (error) {
                console.error("Falha ao inicializar o player:", error);
                showMessage(error.message, true);
            }
        }

        function setupVideoPlayer() {
            videoElement.autoplay = true; 
            videoElement.muted = true;
            videoElement.playsInline = true;

            videoElement.addEventListener('ended', playNextVideo);

            videoElement.addEventListener('canplay', () => {
                videoElement.play().catch(e => {
                    console.warn("Autoplay bloqueado pelo navegador. Interação do usuário pode ser necessária.", e);
                    showMessage("Clique na tela para iniciar o vídeo.", false);
                    document.body.addEventListener('click', () => videoElement.play(), { once: true });
                });
            });
        }

        function playNextVideo() {
            if (playlist.length === 0) return;

            videoElement.src = playlist[currentVideoIndex];
            console.log(`Carregando: ${playlist[currentVideoIndex]}`);
            
            currentVideoIndex++;
            
            if (currentVideoIndex >= playlist.length) {
                currentVideoIndex = 0;
                console.log("Playlist finalizada. Reiniciando...");
            }
        }

        document.addEventListener('DOMContentLoaded', initializePlayer);
    </script>
</body>
</html>
